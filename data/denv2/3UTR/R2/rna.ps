%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.3
%%CreationDate: Tue Jan 16 17:53:06 2018
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
UAGCUCCACCUGAGAAGGUGUAAAAAAUCUGGGAGGCCACAAACCAUGGAAGCUGUACGCAUGGCGUAGUGGACUAGCGGUUAGAGGAGACCCCUCCCUUACAAAUCGCAGCAACAAUGGGGGCCCAAGGUGAGAUGAAGCUGUAGUCUCGC\
) def
/coor [
[29.39591599 452.43591309]
[33.29305649 466.92083740]
[20.83455658 475.27462769]
[8.91399860 466.16964722]
[13.69546795 451.95220947]
[14.51104641 436.97439575]
[7.01460361 436.74343872]
[-0.88187885 449.49667358]
[-8.77836132 462.24993896]
[-16.67484283 475.00320435]
[-24.57132530 487.75646973]
[-24.53523636 504.15557861]
[-38.85310745 512.15124512]
[-52.79594421 503.51818848]
[-52.02054977 487.13739014]
[-37.32458496 479.85998535]
[-29.42810059 467.10671997]
[-21.53161812 454.35345459]
[-13.63513565 441.60018921]
[-5.73865366 428.84695435]
[-18.78270531 436.25320435]
[-27.66059113 424.16259766]
[-29.47410583 409.27261353]
[-23.75784874 395.40451050]
[-11.97877884 386.11721802]
[2.84024334 383.79418945]
[16.89621544 389.03149414]
[26.58265305 400.48663330]
[32.38706970 414.31805420]
[33.92436218 399.39703369]
[26.52334213 389.78002930]
[27.72242165 377.30068970]
[37.42068481 368.73638916]
[35.10719299 361.66815186]
[39.45772934 353.56454468]
[41.60630798 338.71920776]
[43.75488663 323.87390137]
[45.90346527 309.02856445]
[43.73558426 301.91433716]
[48.25158310 293.90173340]
[46.45579910 290.79974365]
[46.10961151 286.65850830]
[47.69161606 282.18606567]
[51.33812714 278.27987671]
[54.69738770 263.66088867]
[58.05664444 249.04187012]
[61.41590500 234.42286682]
[50.41927719 224.37597656]
[45.89793777 210.07865906]
[49.16162491 195.34045410]
[59.43161011 184.14115906]
[74.02355957 179.55616760]
[77.38282013 164.93714905]
[80.74208069 150.31814575]
[84.10134125 135.69914246]
[87.46059418 121.08013153]
[71.61965942 100.51476288]
[82.52258301 72.90560150]
[77.68276215 58.70784760]
[72.84294891 44.51009369]
[67.07745361 37.34386444]
[68.05277252 29.97087669]
[63.50548172 15.67674637]
[58.95819092 1.38261604]
[54.26438904 -12.86407566]
[39.97221375 -19.61013412]
[34.71501923 -34.51440811]
[41.61180496 -48.73446274]
[56.57083130 -53.83378601]
[70.71717072 -46.78704453]
[75.65805817 -31.77494049]
[68.46214294 -17.70389175]
[73.62903595 -12.35455322]
[73.25231934 -3.16467404]
[77.79960632 11.12945557]
[82.34690094 25.42358589]
[87.04070282 39.67027664]
[91.88051605 53.86803055]
[96.72033691 68.06578064]
[111.58692932 70.06184387]
[120.00034332 57.64352417]
[121.33515930 41.87872696]
[134.87942505 35.68178177]
[143.29283142 23.26346970]
[145.53712463 14.34388542]
[152.00865173 10.67898750]
[160.67526245 -1.56396604]
[169.34187317 -13.80692005]
[178.00848389 -26.04987335]
[178.98199463 -42.42009735]
[193.76493835 -49.51917267]
[207.14987183 -40.04417419]
[205.36752319 -23.74217033]
[190.25143433 -17.38326645]
[181.58482361 -5.14031219]
[172.91821289 7.10264158]
[164.25161743 19.34559441]
[155.71115112 31.67687988]
[147.29774475 44.09519196]
[146.56471252 58.97174835]
[132.41865540 66.05693817]
[124.00524902 78.47525024]
[128.95584106 89.05160522]
[129.66983032 100.23702240]
[126.38672638 110.46181488]
[119.88449097 118.41130066]
[111.32939148 123.19440460]
[102.07960510 124.43939209]
[98.72034454 139.05839539]
[95.36108398 153.67739868]
[92.00183105 168.29641724]
[88.64257050 182.91542053]
[99.76937103 193.41024780]
[104.12042999 207.96928406]
[100.62315369 222.65380859]
[90.31420135 233.54331970]
[76.03491211 237.78211975]
[72.67565155 252.40112305]
[69.31639099 267.02014160]
[65.95713806 281.63916016]
[63.04966354 296.35467529]
[60.74878693 311.17715454]
[58.60020828 326.02246094]
[56.45162964 340.86779785]
[54.30305099 355.71310425]
[52.30699539 370.57971191]
[59.88847733 387.32940674]
[48.84537888 400.93432617]
[47.30808640 415.85534668]
[50.21555710 430.57086182]
[57.31196213 443.78607178]
[64.40836334 457.00125122]
[71.50476837 470.21643066]
[78.60117340 483.43161011]
[85.69757843 496.64678955]
[92.79397583 509.86196899]
[108.18166351 510.96771240]
[120.51509857 520.23541260]
[125.85871887 534.70776367]
[122.50740814 549.76672363]
[111.53054810 560.60699463]
[96.43081665 563.76953125]
[82.02648163 558.24517822]
[72.91391754 545.79669189]
[72.00090790 530.39636230]
[79.57879639 516.95837402]
[72.48239136 503.74319458]
[65.38598633 490.52801514]
[58.28958511 477.31283569]
[51.19318008 464.09765625]
[44.09677887 450.88247681]
[37.00037384 437.66726685]
] def
/pairs [
[7 20]
[8 19]
[9 18]
[10 17]
[11 16]
[29 129]
[30 128]
[33 126]
[35 125]
[36 124]
[37 123]
[38 122]
[40 121]
[44 120]
[45 119]
[46 118]
[47 117]
[52 112]
[53 111]
[54 110]
[55 109]
[56 108]
[58 79]
[59 78]
[60 77]
[62 76]
[63 75]
[64 74]
[65 72]
[80 102]
[81 101]
[83 99]
[84 98]
[86 97]
[87 96]
[88 95]
[89 94]
[130 152]
[131 151]
[132 150]
[133 149]
[134 148]
[135 147]
[136 146]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
