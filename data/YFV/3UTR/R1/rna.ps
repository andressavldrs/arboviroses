%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.3
%%CreationDate: Tue Jan 16 17:53:07 2018
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
AACACCAUAUAAUAGGAACAACCGGGAUACAAACCACGGGUGGAGAACCGGACUCCCCACAACCUGAAACCGGGAUACAAACCACGGCUGGAGAACCGGACUCCGCACUUAAAAUGAAACAGAAACCGGGAUAAAAACUACGGAUGGAGAACCGGACUCCACACAUUGAAACAGAAGAAGUUGUCAGCCCAGAACUCCACACGAGUUUUGCCACUGCUAAGCUGUGAGGC\
) def
/coor [
[69.81525421 184.42272949]
[54.02411652 183.77809143]
[43.37550735 172.09979248]
[44.18706131 156.31636047]
[55.97729111 145.79180908]
[56.58912277 130.80429077]
[49.78822327 127.64236450]
[43.46436310 141.24415588]
[37.14049911 154.84594727]
[30.81663704 168.44773865]
[24.49277496 182.04953003]
[18.16891098 195.65133667]
[16.35772133 210.54158020]
[1.63655770 213.42034912]
[-5.65038633 200.30926514]
[4.56711912 189.32746887]
[10.89098167 175.72567749]
[17.21484375 162.12388611]
[23.53870773 148.52209473]
[29.86256981 134.92030334]
[36.18643188 121.31850433]
[29.38553619 118.15657043]
[18.32063484 128.28416443]
[7.25573444 138.41174316]
[-3.74004364 148.61433411]
[-14.66619015 158.89146423]
[-13.59995556 174.49264526]
[-22.85314941 187.09869385]
[-38.05669403 190.75741577]
[-52.03194427 183.74125671]
[-58.18021393 169.36305237]
[-53.59847641 154.41174316]
[-40.45008850 145.94688416]
[-24.94331551 147.96531677]
[-14.01716900 137.68818665]
[-11.30232239 130.82562256]
[-2.87185025 127.34683990]
[8.19305038 117.21925354]
[19.25795174 107.09167480]
[22.49624634 92.44539642]
[16.73244476 78.59697723]
[10.96864223 64.74856567]
[5.20484018 50.90015030]
[-0.55896163 37.05173492]
[-6.32276392 23.20332146]
[-17.92074776 17.58086205]
[-22.44024277 5.93901730]
[-17.96924782 -5.29144335]
[-23.54418564 -19.21696281]
[-29.11912155 -33.14248276]
[-34.69405746 -47.06800079]
[-49.43040466 -58.12063599]
[-46.24035645 -75.38332367]
[-52.00415802 -89.23173523]
[-57.76795959 -103.08015442]
[-63.53176117 -116.92856598]
[-75.20406342 -113.57019043]
[-88.12281036 -113.90770721]
[-101.08235168 -118.35880280]
[-112.74939728 -126.94152832]
[-121.79605865 -139.23910522]
[-127.04125214 -154.40869141]
[-127.58615112 -171.23590088]
[-141.94947815 -175.55964661]
[-156.31280518 -179.88340759]
[-170.67613220 -184.20716858]
[-186.50625610 -179.92474365]
[-197.93756104 -191.68302917]
[-193.21049500 -207.38610840]
[-177.18786621 -210.88000488]
[-166.35237122 -198.57049561]
[-151.98904419 -194.24673462]
[-137.62571716 -189.92297363]
[-123.26239014 -185.59922791]
[-118.58621979 -191.46295166]
[-130.31369019 -200.81530762]
[-142.04116821 -210.16764832]
[-153.76863098 -219.52000427]
[-165.49610901 -228.87234497]
[-177.22343445 -238.22486877]
[-167.87072754 -249.95205688]
[-156.14375305 -240.59982300]
[-144.41629028 -231.24746704]
[-132.68881226 -221.89512634]
[-120.96134186 -212.54277039]
[-109.23387146 -203.19042969]
[-104.55770111 -209.05416870]
[-111.96919250 -222.09524536]
[-118.92008209 -227.99948120]
[-119.39141846 -235.36445618]
[-126.62487793 -248.50512695]
[-133.85833740 -261.64578247]
[-141.09178162 -274.78646851]
[-156.46722412 -277.63775635]
[-166.37275696 -289.73794556]
[-166.13130188 -305.37365723]
[-155.85687256 -317.16220093]
[-140.40072632 -319.53741455]
[-127.06078339 -311.37774658]
[-122.13577271 -296.53598022]
[-127.95111847 -282.01992798]
[-120.71765900 -268.87924194]
[-113.48420715 -255.73858643]
[-106.25075531 -242.59791565]
[-98.92810822 -229.50674438]
[-91.51661682 -216.46565247]
[-84.01661682 -216.46565247]
[-84.26858521 -231.46354675]
[-84.52055359 -246.46142578]
[-84.77252960 -261.45932007]
[-85.02449799 -276.45718384]
[-85.27646637 -291.45507812]
[-85.52843475 -306.45297241]
[-85.78041077 -321.45083618]
[-88.94358063 -336.11352539]
[-76.51641846 -344.51388550]
[-64.08950806 -336.11315918]
[-67.25283051 -321.45083618]
[-67.50479889 -306.45297241]
[-67.75676727 -291.45507812]
[-68.00873566 -276.45718384]
[-68.26070404 -261.45932007]
[-68.51268005 -246.46142578]
[-68.76464844 -231.46354675]
[-69.01661682 -216.46565247]
[-61.51661682 -216.46565247]
[-54.10512543 -229.50674438]
[-46.69363022 -242.54782104]
[-55.41952515 -255.07066345]
[-57.83935165 -270.14074707]
[-53.47264862 -284.76586914]
[-43.18643188 -296.04223633]
[-29.02303314 -301.73089600]
[-13.79461002 -300.70239258]
[-0.52477419 -293.16088867]
[8.15173817 -280.60379028]
[10.51219940 -265.52429199]
[6.08793736 -250.91645813]
[-4.24260664 -239.68069458]
[-18.42829514 -234.04783630]
[-33.65254974 -235.13632202]
[-41.06404495 -222.09524536]
[-48.47553635 -209.05416870]
[-24.59092903 -177.99443054]
[-27.40632820 -143.33956909]
[-49.68334579 -122.69236755]
[-43.91954422 -108.84395599]
[-38.15574265 -94.99553680]
[-32.39194107 -81.14712524]
[-21.33866310 -76.25446320]
[-16.41922569 -64.77589417]
[-20.76853943 -52.64293671]
[-15.19360256 -38.71741867]
[-9.61866570 -24.79189873]
[-4.04372931 -10.86637974]
[10.31629181 -0.76852959]
[7.52565098 17.43951988]
[13.28945255 31.28793335]
[19.05325508 45.13634872]
[24.81705666 58.98476410]
[30.58085823 72.83317566]
[36.34466171 86.68159485]
[51.10594940 51.73897171]
[84.25799561 29.36567688]
[126.31092072 28.66342163]
[163.69766235 52.09568405]
[178.63909912 53.41995621]
[193.58052063 54.74422455]
[208.52195740 56.06849670]
[223.47204590 57.29113770]
[238.43009949 58.41208649]
[253.38815308 59.53303909]
[264.17663574 48.21302795]
[279.72311401 46.52748489]
[292.68701172 55.27227020]
[296.94717407 70.31836700]
[290.49209595 84.56146240]
[276.36965942 91.27641296]
[261.24801636 87.29261017]
[252.26721191 74.49109650]
[237.30914307 73.37014771]
[222.35108948 72.24919128]
[215.45587158 74.87997437]
[207.19767761 71.00992584]
[192.25625610 69.68565369]
[177.31481934 68.36138153]
[162.37339783 67.03711700]
[159.39759827 73.92148590]
[153.44599915 87.69023895]
[150.47019958 94.57461548]
[161.67179871 104.55078125]
[172.87341309 114.52695465]
[184.07501221 124.50312042]
[195.27662659 134.47929382]
[206.47824097 144.45545959]
[217.67984009 154.43164062]
[228.88145447 164.40780640]
[244.91632080 164.92022705]
[254.39741516 177.86196899]
[250.05165100 193.30520630]
[235.21272278 199.40324402]
[221.26379395 191.47814941]
[218.90528870 175.60940552]
[207.70367432 165.63323975]
[196.50205994 155.65707397]
[185.30046082 145.68090820]
[174.09884644 135.70472717]
[162.89724731 125.72856140]
[151.69563293 115.75238800]
[140.49401855 105.77622223]
[134.24035645 109.91645813]
[115.47932434 122.33716583]
[120.28884125 136.54521179]
[125.09835815 150.75325012]
[136.85195923 161.34397888]
[133.60397339 175.88012695]
[138.41348267 190.08818054]
[149.21917725 203.15238953]
[139.65682983 217.15231323]
[123.55690765 211.83923340]
[124.20544434 194.89768982]
[119.39592743 180.68965149]
[107.98632812 171.11518860]
[110.89031219 155.56277466]
[106.08079529 141.35472107]
[101.27127838 127.14668274]
[93.84761810 128.21405029]
[71.57663727 131.41612244]
[70.96480560 146.40364075]
[81.85796356 157.85417175]
] def
/pairs [
[5 229]
[6 228]
[22 39]
[23 38]
[24 37]
[25 35]
[26 34]
[40 162]
[41 161]
[42 160]
[43 159]
[44 158]
[45 157]
[48 155]
[49 154]
[50 153]
[51 152]
[53 149]
[54 148]
[55 147]
[56 146]
[63 74]
[64 73]
[65 72]
[66 71]
[87 106]
[88 105]
[90 104]
[91 103]
[92 102]
[93 101]
[126 143]
[127 142]
[128 141]
[166 187]
[167 186]
[168 185]
[169 184]
[170 182]
[171 181]
[172 180]
[190 210]
[191 209]
[192 208]
[193 207]
[194 206]
[195 205]
[196 204]
[197 203]
[212 226]
[213 225]
[214 224]
[216 222]
[217 221]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
